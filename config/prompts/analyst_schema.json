{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "OddcrawlerFinding",
  "type": "object",
  "required": ["url", "summary", "why_flagged", "risk_tag", "confidence"],
  "properties": {
    "url": {"type":"string", "format":"uri"},
    "summary": {"type":"string", "maxLength": 800},
    "why_flagged": {
      "type":"array",
      "items":{"type":"string"},
      "minItems": 2,
      "maxItems": 6
    },
    "risk_tag": {
      "type":"string",
      "enum": ["harmless-retro","fringe","conspiracy-leaning","coded-forum","unsafe","unknown"]
    },
    "dangerous_content": {
      "type":"object",
      "properties": {
        "present": {"type":"boolean"},
        "category": {
          "type":"string",
          "enum": ["none","self-harm","illegal-trade","adult","extremist","violent","other"]
        },
        "notes": {"type":"string", "maxLength": 300}
      },
      "additionalProperties": false
    },
    "confidence": {"type":"number", "minimum": 0, "maximum": 1}
  },
  "additionalProperties": false
}
